var e=require("axios"),t=require("mapbox-gl/dist/mapbox-gl.js"),s=require("swiper");function o(e){return e&&e.__esModule?e.default:e}const a=()=>{const e=document.querySelector(".alert");e&&e.parentElement.removeChild(e)},n=(e,t,s=5)=>{a();const o=`<div class="alert alert--${e}">${t}</div>`;document.querySelector("body").insertAdjacentHTML("afterbegin",o),window.setTimeout(a,1e3*s)},r=async(t,s)=>{try{"success"===(await o(e)({method:"POST",url:"/api/v1/users/login",data:{email:t,password:s}})).data.status&&(n("success","Logged in successful"),window.setTimeout((()=>{location.assign("/")}),1500))}catch(e){n("error",e.response.data.message)}},d=e=>{o(t).accessToken="pk.eyJ1IjoiY2hhb3Ntb3MiLCJhIjoiY2w1NzRka200MGJ6NjNkbnJiZ3p2bmE0dSJ9.TXqs-zdQ4imeEM5q6Qgxkw";const s=new(o(t).Map)({container:"map",style:"mapbox://styles/chaosmos/cl57609oo005m14pn7xcnjhz2",center:[-118.113491,34.111745],zoom:10,scrollZoom:!1});s.on("style.load",(()=>{s.setFog({})}));const a=new(o(t).LngLatBounds);e.forEach((e=>{const n=document.createElement("div");n.className="marker",new(o(t).Marker)({element:n,anchor:"bottom"}).setLngLat(e.coordinates).addTo(s),new(o(t).Popup)({offset:30}).setLngLat(e.coordinates).setHTML(`<p>Day ${e.day}: ${e.description}</p>`).addTo(s),a.extend(e.coordinates)})),s.fitBounds(a,{padding:{top:200,bottom:100,left:100,right:100}})},c=async(t,s)=>{try{const a="password"===s?"/api/v1/users/updateMyPassword":"/api/v1/users/updateMe";"success"===(await o(e)({method:"PATCH",url:a,data:t})).data.status&&n("success",`${s.toUpperCase()} Data updated successfully!`),setTimeout((()=>{location.reload()}),900)}catch(e){n("error",e.response.data.message)}},u=Stripe("pk_test_51LJadxCOpTT3xkBxeE5MTRWS6JZHtyEEt1qx4DqPLeM4N6f7nseAOHDEeA6q0HCsCIJiFRuTXohZcDNJDSrHZgJR00eBPke8YJ"),i=async t=>{try{const s=await o(e)(`/api/v1/bookings/checkout-session/${t}`);await u.redirectToCheckout({sessionId:s.data.session.id})}catch(e){console.log(e),n("error",e)}},l=async(t,s,a,r)=>{try{const d=await o(e)({method:"POST",url:"/api/v1/users/signup",data:{name:t,email:s,password:a,passwordConfirm:r}});console.log("hello from sign up!"),"success"===d.data.status&&(n("success","Account created successfully"),window.setTimeout((()=>{location.assign("/")}),1e3)),console.log("hello from sign up!")}catch(e){n("error",e.response.data.message)}};new(o(s))(".reviews",{modules:[s.Navigation],slidesPerView:"auto",loop:!0,breakpoints:{300:{slidesPerView:1.5,spaceBetween:15},768:{slidesPerView:2,spaceBetween:20},1280:{slidesPerView:3,spaceBetween:30},1920:{slidesPerView:5,spaceBetween:45}},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}});const m=document.getElementById("map"),p=document.querySelector(".form--login"),g=document.querySelector(".nav__el--logout"),w=document.querySelector(".form-user-data"),y=document.querySelector(".form-user-password"),v=document.getElementById("book-tour"),E=document.querySelector(".signup-form");if(m){d(JSON.parse(m.dataset.locations))}E&&E.addEventListener("submit",(async e=>{e.preventDefault(),document.querySelector(".btn--signup").innerText="Signing...";const t=document.getElementById("name").value,s=document.getElementById("email").value,o=document.getElementById("password").value,a=document.getElementById("password-confirm").value;await l(t,s,o,a),document.querySelector(".btn--signup").innerText="Sign Up",E.reset()})),p&&document.querySelector(".form").addEventListener("submit",(e=>{e.preventDefault();const t=document.getElementById("email").value,s=document.getElementById("password").value;r(t,s)})),g&&g.addEventListener("click",(async()=>{try{(await o(e)({method:"GET",url:"/api/v1/users/logout"})).data.status="success",window.setTimeout((()=>{location.assign("/")}),1500)}catch(e){n("error",e.response.data.message,"Error logging out! Try again.")}})),w&&w.addEventListener("submit",(e=>{e.preventDefault();const t=new FormData;t.append("name",document.getElementById("name").value),t.append("email",document.getElementById("email").value),t.append("photo",document.getElementById("photo").files[0]),c(t,"data")})),y&&y.addEventListener("submit",(async e=>{e.preventDefault(),document.querySelector(".btn--save-password").textContent="Updating...";const t=document.getElementById("password-current").value,s=document.getElementById("password").value,o=document.getElementById("password-confirm").value;await c({passwordCurrent:t,password:s,passwordConfirm:o},"password"),document.querySelector(".btn--save-password").textContent="Save Password",document.getElementById("password-current").value="",document.getElementById("password").value="",document.getElementById("password-confirm").value=""})),v&&v.addEventListener("click",(e=>{e.target.textContent="Processing...";const{tourId:t}=e.target.dataset;i(t)}));const f=document.querySelector("body").dataset.alert;alert&&n("success",f,20),console.log("h! from index.js!!!");
//# sourceMappingURL=index.js.map
